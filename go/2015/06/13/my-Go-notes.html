<!DOCTYPE html>
<html lang="zh">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Go语言学习笔记</title>
  <meta name="description" content="Go是一种并发的、带垃圾回收的、快速编译的静态语言，用于编写简单、可靠、高效的软件。多用在云计算方面。">
  
  <meta name="keywords" content="Go语言,Go,notes,笔记">
  
  <link href="//fonts.useso.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet" type="text/css">
  <!--
  <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
  -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://lin-h.com/go/2015/06/13/my-Go-notes.html">
  <link rel="alternate" type="application/rss+xml" title="LinHang's Blog" href="http://lin-h.com/feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">LinHang's Blog</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Go语言学习笔记</h1>
    <p class="post-meta">Jun 13, 2015</p>
  </header>

  <article class="post-content">
    <h2 id="go">Go简介</h2>

<p><code class="highlighter-rouge">Go</code>是一种并发的、带垃圾回收的、快速编译的静态语言，用于编写简单、可靠、高效的软件。多用在云计算方面。</p>

<h2 id="package">package(包)</h2>

<p>每个 Go 程序都是由包组成的，程序运行的入口是函数 <code class="highlighter-rouge">main</code>，使用<code class="highlighter-rouge">import</code>关键字导入其他的包</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">package</span><span class="x"> </span><span class="n">main</span><span class="x">

</span><span class="k">import</span><span class="x"> </span><span class="p">(</span><span class="x">       </span><span class="c">//import "fmt"</span><span class="x">
	</span><span class="s">"fmt"</span><span class="x">
	</span><span class="s">"math/rand"</span><span class="x">
</span><span class="p">)</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"My favorite number is"</span><span class="p">,</span><span class="x"> </span><span class="n">rand</span><span class="o">.</span><span class="n">Intn</span><span class="p">(</span><span class="m">10</span><span class="p">))</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<blockquote>
  <p>在Go的包中，只有首字母大写的函数时被导出的，小写的函数不会被导出</p>
</blockquote>

<h2 id="section">变量</h2>

<p>变量的类型跟在变量名之后，若有初始值则可省略类型声明，<code class="highlighter-rouge">Go</code>可以自动推导</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span><span class="x"> </span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="n">python</span><span class="p">,</span><span class="x"> </span><span class="n">java</span><span class="x"> </span><span class="kt">bool</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="no">true</span><span class="x"> </span><span class="c">//定义并初始化变量</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">var</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="kt">int</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="x"> </span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="n">python</span><span class="p">,</span><span class="x"> </span><span class="n">java</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<p>在函数内还可以使用简写方式<code class="highlighter-rouge">:=</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">var</span><span class="x"> </span><span class="n">i</span><span class="p">,</span><span class="x"> </span><span class="n">j</span><span class="x"> </span><span class="kt">int</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="m">1</span><span class="p">,</span><span class="x"> </span><span class="m">2</span><span class="x">
	</span><span class="n">k</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">3</span><span class="x">
	</span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="n">python</span><span class="p">,</span><span class="x"> </span><span class="n">java</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="no">true</span><span class="p">,</span><span class="x"> </span><span class="no">false</span><span class="p">,</span><span class="x"> </span><span class="s">"no!"</span><span class="x">

	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="x"> </span><span class="n">j</span><span class="p">,</span><span class="x"> </span><span class="n">k</span><span class="p">,</span><span class="x"> </span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="n">python</span><span class="p">,</span><span class="x"> </span><span class="n">java</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h2 id="section-1">基本类型</h2>

<ul>
  <li>bool</li>
  <li>string</li>
  <li>int  int8  int16  int32  int64</li>
  <li>uint uint8 uint16 uint32 uint64 uintptr</li>
  <li>byte   uint8 的别名</li>
  <li>rune   int32 的别名 代表一个Unicode码</li>
  <li>float32 float64</li>
  <li>complex64 complex128</li>
</ul>

<h3 id="section-2">零值</h3>

<p>当变量定以后没有进行赋值的话，变量将会被赋值<code class="highlighter-rouge">零值</code></p>

<ul>
  <li>数值类型为 <code class="highlighter-rouge">0</code>，</li>
  <li>bool为 <code class="highlighter-rouge">false</code>，</li>
  <li>字符串为 <code class="highlighter-rouge">""</code>(空串)</li>
  <li>指针为 <code class="highlighter-rouge">nil</code></li>
  <li>slice 为<code class="highlighter-rouge">nil</code>，长度和容量都是0</li>
  <li>map 为<code class="highlighter-rouge">nil</code></li>
</ul>

<h3 id="section-3">类型转换</h3>

<p>表达式 T(v) 将值 v 转换为类型 <code class="highlighter-rouge">T</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="kt">int</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="m">42</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">f</span><span class="x"> </span><span class="kt">float64</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="kt">float64</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">u</span><span class="x"> </span><span class="kt">uint</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="kt">uint</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="x">
</span></code></pre>
</div>

<h3 id="section-4">常量</h3>

<p>使用<code class="highlighter-rouge">const</code>关键字，数值常量是高精度的值</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">const</span><span class="x"> </span><span class="n">Pi</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="m">3.14</span><span class="x">
</span><span class="k">const</span><span class="x"> </span><span class="n">World</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="s">"世界"</span><span class="x">
</span></code></pre>
</div>

<h2 id="section-5">函数</h2>

<p>使用<code class="highlighter-rouge">func</code>定义函数，函数参数的类型在参数之后，最后是函数的返回值类型</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="x"> </span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="kt">int</span><span class="x"> </span><span class="p">{</span><span class="c">//参数可以缩写为(x, y int)</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="n">x</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">y</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="m">42</span><span class="p">,</span><span class="x"> </span><span class="m">13</span><span class="p">))</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<p><code class="highlighter-rouge">Go</code>中的函数可以返回多个值，还可以将返回的变量命名,并且像变量那样使用</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="x"> </span><span class="kt">string</span><span class="p">)</span><span class="x"> </span><span class="p">(</span><span class="n">a</span><span class="x"> </span><span class="kt">string</span><span class="p">,</span><span class="x"> </span><span class="n">b</span><span class="x"> </span><span class="kt">string</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="n">y</span><span class="p">,</span><span class="x"> </span><span class="n">x</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<p>函数是值，可以传递给变量，也可以当做另一个函数的返回值</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">hypot</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="k">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="x"> </span><span class="kt">float64</span><span class="p">)</span><span class="x"> </span><span class="kt">float64</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">return</span><span class="x"> </span><span class="n">math</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="x">
	</span><span class="p">}</span><span class="x">

	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">hypot</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="x"> </span><span class="m">4</span><span class="p">))</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="c">//adder函数返回另一个函数</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="n">adder</span><span class="p">()</span><span class="x"> </span><span class="k">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="kt">int</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">sum</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">0</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="k">func</span><span class="p">(</span><span class="n">x</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="kt">int</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="n">sum</span><span class="x"> </span><span class="o">+=</span><span class="x"> </span><span class="n">x</span><span class="x">
		</span><span class="k">return</span><span class="x"> </span><span class="n">sum</span><span class="x">
	</span><span class="p">}</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h2 id="section-6">控制语句</h2>

<h3 id="for">for</h3>

<p><code class="highlighter-rouge">Go</code>中只有一种循环结构<code class="highlighter-rouge">for</code>，结构与<code class="highlighter-rouge">C语言</code>的<code class="highlighter-rouge">for</code>语句类似，但却没有了括号</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">for</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">0</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="m">10</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="o">++</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">sum</span><span class="x"> </span><span class="o">+=</span><span class="x"> </span><span class="n">i</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">sum</span><span class="p">)</span><span class="x">
</span><span class="c">//与C一样可以省略部分语句</span><span class="x">
</span><span class="k">for</span><span class="x"> </span><span class="n">sum</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="m">1000</span><span class="x"> </span><span class="p">{</span><span class="c">//起到while语句的作用</span><span class="x">
	</span><span class="n">sum</span><span class="x"> </span><span class="o">+=</span><span class="x"> </span><span class="n">sum</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="c">//死循环</span><span class="x">
</span><span class="k">for</span><span class="x"> </span><span class="p">{</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h3 id="if">if</h3>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span><span class="x"> </span><span class="n">v</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">math</span><span class="o">.</span><span class="n">Pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">n</span><span class="p">);</span><span class="x"> </span><span class="n">v</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="n">lim</span><span class="x"> </span><span class="p">{</span><span class="c">//变量v的作用域是if语句</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="n">v</span><span class="x">
</span><span class="p">}</span><span class="x"> </span><span class="k">else</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%g &gt;= %g</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="x"> </span><span class="n">v</span><span class="p">,</span><span class="x"> </span><span class="n">lim</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h3 id="switch">switch</h3>

<p><code class="highlighter-rouge">Go</code>的<code class="highlighter-rouge">switch</code>语句与<code class="highlighter-rouge">C语言</code>的不同，默认情况下，执行了一个分之后不会向下继续执行，匹配成功后就会跳出，除非使用了<code class="highlighter-rouge">fallthrough</code>继续向下执行。</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">today</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="o">.</span><span class="n">Weekday</span><span class="p">()</span><span class="x">
</span><span class="k">switch</span><span class="x"> </span><span class="n">time</span><span class="o">.</span><span class="n">Saturday</span><span class="x"> </span><span class="p">{</span><span class="x">
</span><span class="k">case</span><span class="x"> </span><span class="n">today</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="m">0</span><span class="o">:</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Today."</span><span class="p">)</span><span class="x">
</span><span class="k">case</span><span class="x"> </span><span class="n">today</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="m">1</span><span class="o">:</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Tomorrow."</span><span class="p">)</span><span class="x">
</span><span class="k">case</span><span class="x"> </span><span class="n">today</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="m">2</span><span class="o">:</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"In two days."</span><span class="p">)</span><span class="x">
	</span><span class="k">fallthrough</span><span class="x">
</span><span class="k">default</span><span class="o">:</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Too far away."</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="c">//switch true 的用法  简化多个if-else语句</span><span class="x">
</span><span class="n">t</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="x">
</span><span class="k">switch</span><span class="x"> </span><span class="p">{</span><span class="x">
</span><span class="k">case</span><span class="x"> </span><span class="n">t</span><span class="o">.</span><span class="n">Hour</span><span class="p">()</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="m">12</span><span class="o">:</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Good morning!"</span><span class="p">)</span><span class="x">
</span><span class="k">case</span><span class="x"> </span><span class="n">t</span><span class="o">.</span><span class="n">Hour</span><span class="p">()</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="m">17</span><span class="o">:</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Good afternoon."</span><span class="p">)</span><span class="x">
</span><span class="k">default</span><span class="o">:</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Good evening."</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h3 id="defer">defer</h3>

<p>延迟函数的执行，直到上层函数返回时才执行。延迟的函数调用被压入一个栈中，然后按照先进后出的顺序执行。</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">defer</span><span class="x"> </span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"world"</span><span class="p">)</span><span class="c">//在main函数结束后才执行该语句</span><span class="x">

	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"hello"</span><span class="p">)</span><span class="c">//输出结果为helloworld</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h2 id="point">Point(指针)</h2>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span><span class="x"> </span><span class="n">p</span><span class="x"> </span><span class="o">*</span><span class="kt">int</span><span class="c">//定义int类型的指针</span><span class="x">
</span><span class="n">i</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">42</span><span class="x">
</span><span class="n">p</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="o">&amp;</span><span class="n">i</span><span class="x"> </span><span class="c">//取变量i的地址</span><span class="x">
</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="c">//输出p所指的值</span><span class="x">
</span></code></pre>
</div>

<h2 id="struct">Struct(结构体)</h2>

<p>结构体使用中的字段<code class="highlighter-rouge">.</code>来访问，也可以通过指针简介访问。<code class="highlighter-rouge">type</code>关键字用来定义一种类型</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">type</span><span class="x"> </span><span class="n">Vertex</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">X</span><span class="x"> </span><span class="kt">int</span><span class="x">
	</span><span class="n">Y</span><span class="x"> </span><span class="kt">int</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">v</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">Vertex</span><span class="p">{</span><span class="m">1</span><span class="p">,</span><span class="x"> </span><span class="m">2</span><span class="p">}</span><span class="x">
	</span><span class="n">v</span><span class="o">.</span><span class="n">X</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="m">4</span><span class="x">   </span><span class="c">//通过变量访问</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">X</span><span class="p">)</span><span class="x">
	</span><span class="n">p</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="o">&amp;</span><span class="n">v</span><span class="x">   </span><span class="c">//通过指针访问</span><span class="x">
	</span><span class="n">p</span><span class="o">.</span><span class="n">X</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="m">1e9</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h2 id="array">Array(数组)</h2>

<p>类型<code class="highlighter-rouge">[n]T</code>是一个有n个类型为T的元素的数组，数组下标从0开始，并且是固定长度</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">var</span><span class="x"> </span><span class="n">a</span><span class="x"> </span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="kt">string</span><span class="c">//定义一个有2个元素的string数组</span><span class="x">
	</span><span class="n">a</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="s">"Hello"</span><span class="x">
	</span><span class="n">a</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="s">"World"</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="x"> </span><span class="n">a</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">

</span></code></pre>
</div>

<h2 id="slice">slice</h2>

<p><code class="highlighter-rouge">slice</code>会指向一个序列的值，并且包含了长度信息,<code class="highlighter-rouge">[]T</code>是一个元素类型为T的<code class="highlighter-rouge">slice</code>，在声明时没有指定大小的数组</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">p</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="m">2</span><span class="p">,</span><span class="x"> </span><span class="m">3</span><span class="p">,</span><span class="x"> </span><span class="m">5</span><span class="p">,</span><span class="x"> </span><span class="m">7</span><span class="p">,</span><span class="x"> </span><span class="m">11</span><span class="p">,</span><span class="x"> </span><span class="m">13</span><span class="p">}</span><span class="x">
</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"p =="</span><span class="p">,</span><span class="x"> </span><span class="n">p</span><span class="p">)</span><span class="x">
</span></code></pre>
</div>

<p>重新slice</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">p</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="m">2</span><span class="p">,</span><span class="x"> </span><span class="m">3</span><span class="p">,</span><span class="x"> </span><span class="m">5</span><span class="p">,</span><span class="x"> </span><span class="m">7</span><span class="p">,</span><span class="x"> </span><span class="m">11</span><span class="p">,</span><span class="x"> </span><span class="m">13</span><span class="p">}</span><span class="x">
</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"p[1:4] =="</span><span class="p">,</span><span class="x"> </span><span class="n">p</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="c">//1到3元素</span><span class="x">
</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"p[:3] =="</span><span class="p">,</span><span class="x"> </span><span class="n">p</span><span class="p">[</span><span class="o">:</span><span class="m">3</span><span class="p">])</span><span class="c">//0到2元素</span><span class="x">
</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"p[4:] =="</span><span class="p">,</span><span class="x"> </span><span class="n">p</span><span class="p">[</span><span class="m">4</span><span class="o">:</span><span class="p">])</span><span class="c">//从4开始到最后的元素</span><span class="x">
</span></code></pre>
</div>

<p>构造slice</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">a</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="m">5</span><span class="p">)</span><span class="x">  </span><span class="c">// len(a)=5</span><span class="x">
</span><span class="n">b</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="m">0</span><span class="p">,</span><span class="x"> </span><span class="m">5</span><span class="p">)</span><span class="c">//使用第三个参数可以指定容量len(b)=0, cap(b)=5</span><span class="x">
</span></code></pre>
</div>

<p>使用<code class="highlighter-rouge">append</code>函数向slice添加元素</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span><span class="x"> </span><span class="n">a</span><span class="x"> </span><span class="p">[]</span><span class="kt">int</span><span class="x">
</span><span class="n">printSlice</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span><span class="x"> </span><span class="n">a</span><span class="p">)</span><span class="x">
</span><span class="n">a</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="nb">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="x"> </span><span class="m">2</span><span class="p">,</span><span class="x"> </span><span class="m">3</span><span class="p">,</span><span class="x"> </span><span class="m">4</span><span class="p">)</span><span class="c">//append会返回一个新的slice，添加的元素在末尾</span><span class="x">
</span></code></pre>
</div>

<h3 id="forslice">使用for对slice进行遍历</h3>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span><span class="x"> </span><span class="n">pow</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="m">1</span><span class="p">,</span><span class="x"> </span><span class="m">2</span><span class="p">,</span><span class="x"> </span><span class="m">4</span><span class="p">,</span><span class="x"> </span><span class="m">8</span><span class="p">,</span><span class="x"> </span><span class="m">16</span><span class="p">,</span><span class="x"> </span><span class="m">32</span><span class="p">,</span><span class="x"> </span><span class="m">64</span><span class="p">,</span><span class="x"> </span><span class="m">128</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">for</span><span class="x"> </span><span class="n">i</span><span class="p">,</span><span class="x"> </span><span class="n">v</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="k">range</span><span class="x"> </span><span class="n">pow</span><span class="x"> </span><span class="p">{</span><span class="c">//还可以将i替换成_来忽略索引值</span><span class="x">
		</span><span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"2**%d = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="x"> </span><span class="n">i</span><span class="p">,</span><span class="x"> </span><span class="n">v</span><span class="p">)</span><span class="x">
	</span><span class="p">}</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h2 id="map">map</h2>

<p>键值映射，类似于<code class="highlighter-rouge">Python</code>中的字典，<code class="highlighter-rouge">map</code>必须用<code class="highlighter-rouge">make</code>创建</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">type</span><span class="x"> </span><span class="n">Vertex</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="c">//定义一个结构体</span><span class="x">
	</span><span class="n">Lat</span><span class="p">,</span><span class="x"> </span><span class="n">Long</span><span class="x"> </span><span class="kt">float64</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="c">//声明map类型的变量,键是string,值是Vertex</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">m</span><span class="x"> </span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="n">Vertex</span><span class="x"> </span><span class="c">//也可以初始化map，在声明后加上大括号，里面加上初始值</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">m</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="n">Vertex</span><span class="p">)</span><span class="x">
	</span><span class="n">m</span><span class="p">[</span><span class="s">"Bell Labs"</span><span class="p">]</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">Vertex</span><span class="p">{</span><span class="x">
		</span><span class="m">40.68433</span><span class="p">,</span><span class="x"> </span><span class="o">-</span><span class="m">74.39967</span><span class="p">,</span><span class="x">
	</span><span class="p">}</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s">"Bell Labs"</span><span class="p">])</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="c">//或者省略键名</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">m</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="n">Vertex</span><span class="p">{</span><span class="x">
	</span><span class="s">"Bell Labs"</span><span class="o">:</span><span class="x"> </span><span class="p">{</span><span class="m">40.68433</span><span class="p">,</span><span class="x"> </span><span class="o">-</span><span class="m">74.39967</span><span class="p">},</span><span class="x">
	</span><span class="s">"Google"</span><span class="o">:</span><span class="x">    </span><span class="p">{</span><span class="m">37.42202</span><span class="p">,</span><span class="x"> </span><span class="o">-</span><span class="m">122.08408</span><span class="p">},</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h3 id="map-1">对map的操作</h3>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">//插入或修改</span><span class="x">
</span><span class="n">m</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">elem</span><span class="x">
</span><span class="c">//读取</span><span class="x">
</span><span class="n">elem</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">m</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="x">
</span><span class="c">//删除</span><span class="x">
</span><span class="nb">delete</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="x"> </span><span class="n">key</span><span class="p">)</span><span class="x">
</span><span class="c">//判断某个键是否存在，若存在ok=true,否则ok=false</span><span class="x">
</span><span class="n">elem</span><span class="p">,</span><span class="x"> </span><span class="n">ok</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">m</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="x">
</span></code></pre>
</div>

<h2 id="method">Method</h2>

<p><code class="highlighter-rouge">Go</code>中没有类，但可以在结构体上定义方法，除了结构体以外，还可以对其他类型添加方法</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">type</span><span class="x"> </span><span class="n">Vertex</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">X</span><span class="p">,</span><span class="x"> </span><span class="n">Y</span><span class="x"> </span><span class="kt">float64</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="c">//(v *Vertex)为Abs方法的接收者，这里的v(可以使用其他名称)相当于类中的this，指代当前对象(Vertex类型的变量)</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">v</span><span class="x"> </span><span class="o">*</span><span class="n">Vertex</span><span class="p">)</span><span class="x"> </span><span class="n">Abs</span><span class="p">()</span><span class="x"> </span><span class="kt">float64</span><span class="x"> </span><span class="p">{</span><span class="c">//使用指针类型来避免值传递，而且可以修改v变量</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="n">math</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">X</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">X</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">v</span><span class="o">.</span><span class="n">Y</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">Y</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">v</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="o">&amp;</span><span class="n">Vertex</span><span class="p">{</span><span class="m">3</span><span class="p">,</span><span class="x"> </span><span class="m">4</span><span class="p">}</span><span class="c">//定义一个Vertex类型的变量</span><span class="x">
	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">Abs</span><span class="p">())</span><span class="c">//该变量中就拥有了Abs这个方法</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h2 id="interface">Interface(接口)</h2>

<p>接口是一些方法的集合或其他的接口，这些方法只有声明部分，并没有被实现。接口类型的变量可以存放任何实现了这些方法的变量。</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">type</span><span class="x"> </span><span class="n">Vertex</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">X</span><span class="p">,</span><span class="x"> </span><span class="n">Y</span><span class="x"> </span><span class="kt">float64</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="k">type</span><span class="x"> </span><span class="n">Abser</span><span class="x"> </span><span class="k">interface</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">Abs</span><span class="p">()</span><span class="x"> </span><span class="kt">float64</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">v</span><span class="x"> </span><span class="o">*</span><span class="n">Vertex</span><span class="p">)</span><span class="x"> </span><span class="n">Abs</span><span class="p">()</span><span class="x"> </span><span class="kt">float64</span><span class="x"> </span><span class="p">{</span><span class="c">//*Vertex类型实现了Abser接口中的Abs方法</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="n">math</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">X</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">X</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">v</span><span class="o">.</span><span class="n">Y</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">Y</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">v</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="o">&amp;</span><span class="n">Vertex</span><span class="p">{</span><span class="m">3</span><span class="p">,</span><span class="x"> </span><span class="m">4</span><span class="p">}</span><span class="c">//定义一个Vertex类型的变量</span><span class="x">
	</span><span class="k">var</span><span class="x"> </span><span class="n">a</span><span class="x"> </span><span class="n">Abser</span><span class="x">  </span><span class="c">//定义一个Abser接口类型的变量</span><span class="x">
	</span><span class="n">a</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="o">&amp;</span><span class="n">v</span><span class="x">   </span><span class="c">//因为*Vertex类型实现了Abser接口，所以a可以存放*Vertex的变量</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<p>在<code class="highlighter-rouge">fmt</code>包中，有一个通用的接口<code class="highlighter-rouge">Stringer</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">type</span><span class="x"> </span><span class="n">Stringer</span><span class="x"> </span><span class="k">struct</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="n">String</span><span class="p">()</span><span class="x"> </span><span class="kt">string</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<p>接口中的<code class="highlighter-rouge">String()</code>方法类似于<code class="highlighter-rouge">Java</code>的<code class="highlighter-rouge">toString()</code>，作用是用字符串描述自身</p>

<h2 id="error">Error(错误)</h2>

<p>与<code class="highlighter-rouge">Stringer</code>类似，<code class="highlighter-rouge">error</code>也是一个通用接口，返回值类型为<code class="highlighter-rouge">error</code>的函数，可以检查该错误是否等于<code class="highlighter-rouge">nil</code>来判断是否出错</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">i</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">strconv</span><span class="o">.</span><span class="n">Atoi</span><span class="p">(</span><span class="s">"42"</span><span class="p">)</span><span class="x">
</span><span class="k">if</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="o">!=</span><span class="x"> </span><span class="no">nil</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"couldn't convert number: %v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Converted integer:"</span><span class="p">,</span><span class="x"> </span><span class="n">i</span><span class="p">)</span><span class="x">
</span></code></pre>
</div>

<h2 id="goroutine">goroutine</h2>

<p><code class="highlighter-rouge">goroutine</code>是由<code class="highlighter-rouge">Go</code>运行时环境管理的轻量级线程</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">go</span><span class="x"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="p">,</span><span class="x"> </span><span class="n">z</span><span class="p">)</span><span class="c">//定义f函数以另一条线程运行</span><span class="x">
</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="p">,</span><span class="x"> </span><span class="n">z</span><span class="p">)</span><span class="c">//运行f函数</span><span class="x">
</span></code></pre>
</div>

<p><code class="highlighter-rouge">goroutine</code>在相同的地址空间中运行，因此访问共享内存必须进行同步，使用<code class="highlighter-rouge">sync</code>关键字(但并不常用)</p>

<h2 id="channel">channel</h2>

<p><code class="highlighter-rouge">channel</code>是有类型的管道(阻塞式)，使用<code class="highlighter-rouge">&lt;-</code>符号来操作(代表数据流通方向)，<code class="highlighter-rouge">channel</code>使用关键字<code class="highlighter-rouge">chan</code>定义，之后需要使用<code class="highlighter-rouge">make</code>来创建</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="x"> </span><span class="p">[]</span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="n">c</span><span class="x"> </span><span class="k">chan</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">sum</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">0</span><span class="x">
	</span><span class="k">for</span><span class="x"> </span><span class="n">_</span><span class="p">,</span><span class="x"> </span><span class="n">v</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="k">range</span><span class="x"> </span><span class="n">a</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="n">sum</span><span class="x"> </span><span class="o">+=</span><span class="x"> </span><span class="n">v</span><span class="x">
	</span><span class="p">}</span><span class="x">
	</span><span class="n">c</span><span class="x"> </span><span class="o">&lt;-</span><span class="x"> </span><span class="n">sum</span><span class="x"> </span><span class="c">// 将和送入 c</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">a</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="m">7</span><span class="p">,</span><span class="x"> </span><span class="m">2</span><span class="p">,</span><span class="x"> </span><span class="m">8</span><span class="p">,</span><span class="x"> </span><span class="o">-</span><span class="m">9</span><span class="p">,</span><span class="x"> </span><span class="m">4</span><span class="p">,</span><span class="x"> </span><span class="m">0</span><span class="p">}</span><span class="x">
	</span><span class="c">//ch := make(chan int)</span><span class="x">
	</span><span class="n">c</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">chan</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="c">//管道的类型是int</span><span class="x">
	</span><span class="k">go</span><span class="x"> </span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="o">:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="m">2</span><span class="p">],</span><span class="x"> </span><span class="n">c</span><span class="p">)</span><span class="x">
	</span><span class="k">go</span><span class="x"> </span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="m">2</span><span class="o">:</span><span class="p">],</span><span class="x"> </span><span class="n">c</span><span class="p">)</span><span class="x">
	</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="o">&lt;-</span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="o">&lt;-</span><span class="n">c</span><span class="x"> </span><span class="c">// 从 c 中获取</span><span class="x">

	</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="p">,</span><span class="x"> </span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<p>缓冲管道定义的方式，第二个参数定义缓冲区长度，只有在缓冲区满的时候才会阻塞</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">ch</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">chan</span><span class="x"> </span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="m">100</span><span class="p">)</span><span class="x">
</span></code></pre>
</div>

<h3 id="range-and-close">range and close</h3>

<p>使用<code class="highlighter-rouge">close</code>来关闭管道，例如循环 <code class="highlighter-rouge">for i := range c</code> 会不断从 channel 接收值，直到它被关闭(其他情况下一般无需关闭)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="x"> </span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="n">c</span><span class="x"> </span><span class="k">chan</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">0</span><span class="p">,</span><span class="x"> </span><span class="m">1</span><span class="x">
	</span><span class="k">for</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">0</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="n">n</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="o">++</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="n">c</span><span class="x"> </span><span class="o">&lt;-</span><span class="x"> </span><span class="n">x</span><span class="x">
		</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">y</span><span class="p">,</span><span class="x"> </span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="x">
	</span><span class="p">}</span><span class="x">
	</span><span class="nb">close</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">c</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">chan</span><span class="x"> </span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="m">10</span><span class="p">)</span><span class="x">
	</span><span class="k">go</span><span class="x"> </span><span class="n">fibonacci</span><span class="p">(</span><span class="nb">cap</span><span class="p">(</span><span class="n">c</span><span class="p">),</span><span class="x"> </span><span class="n">c</span><span class="p">)</span><span class="x">
	</span><span class="k">for</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="k">range</span><span class="x"> </span><span class="n">c</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="x">
	</span><span class="p">}</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h2 id="select">select</h2>

<p>select 语句使得一个<code class="highlighter-rouge">goroutine</code>在多个操作上等待，select 会阻塞，直到条件分支中的某个可以继续执行，这时就会执行那个条件分支。当多个都准备好的时候，会随机选择一个。</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">fibonacci</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="n">quit</span><span class="x"> </span><span class="k">chan</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">0</span><span class="p">,</span><span class="x"> </span><span class="m">1</span><span class="x">
	</span><span class="k">for</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">select</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">case</span><span class="x"> </span><span class="n">c</span><span class="x"> </span><span class="o">&lt;-</span><span class="x"> </span><span class="n">x</span><span class="o">:</span><span class="x">
			</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">y</span><span class="p">,</span><span class="x"> </span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="x">
		</span><span class="k">case</span><span class="x"> </span><span class="o">&lt;-</span><span class="n">quit</span><span class="o">:</span><span class="x">
			</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"quit"</span><span class="p">)</span><span class="x">
			</span><span class="k">return</span><span class="x">
		</span><span class="k">default</span><span class="o">:</span><span class="x">	</span><span class="c">//当其他分支都没有准备好时，选择default</span><span class="x">
			</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"default"</span><span class="p">)</span><span class="x">
		</span><span class="p">}</span><span class="x">
	</span><span class="p">}</span><span class="x">
</span><span class="p">}</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">c</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">chan</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x">
	</span><span class="n">quit</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="nb">make</span><span class="p">(</span><span class="k">chan</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x">
	</span><span class="k">go</span><span class="x"> </span><span class="k">func</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="k">for</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">0</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="x"> </span><span class="o">&lt;</span><span class="x"> </span><span class="m">10</span><span class="p">;</span><span class="x"> </span><span class="n">i</span><span class="o">++</span><span class="x"> </span><span class="p">{</span><span class="x">
			</span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="n">c</span><span class="p">)</span><span class="x">
		</span><span class="p">}</span><span class="x">
		</span><span class="n">quit</span><span class="x"> </span><span class="o">&lt;-</span><span class="x"> </span><span class="m">0</span><span class="x">
	</span><span class="p">}()</span><span class="x">
	</span><span class="n">fibonacci</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="n">quit</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<h2 id="section-7">参考链接</h2>

<ul>
  <li><a href="http://tour.studygolang.com/list">Go 指南</a></li>
</ul>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">LinHang's Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>LinHang's Blog</li>
          <li><p class="rss-subscribe">subscribe <a href="/feed.xml">via RSS</a></p></li>
          <li><a href="mailto:lh04667649@gmail.com">lh04667649@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/Lin-H">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">Lin-H</span>
            </a>
          </li>
          
          
          <li>
            <a href="http://weibo.com/u/2605326267">
              <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="300" height="300" viewBox="0, 0, 300, 300"><path d="M196.802 39.964c-8.656 3.787-10.64 12.803-4.328 19.115 3.066 3.066 5.951 3.607 18.574 3.607 17.673 0 29.575 4.688 38.592 15.148 11 12.443 12.263 16.23 12.263 38.952 0 20.197 0 20.558 4.688 23.263 10.82 6.131 18.034-1.443 20.558-21.64 3.246-26.329-12.443-56.986-36.066-71.052-15.509-9.016-42.018-12.623-54.281-7.393zm-88.724 33.542c-20.198 7.213-39.674 21.099-60.592 43.46-49.592 52.658-46.346 102.791 8.295 129.48 56.805 27.771 133.267 18.574 174.924-21.099 31.198-29.575 27.411-66.724-8.115-79.347-6.312-2.164-8.296-3.787-7.394-5.771 3.246-7.934 4.328-17.131 2.525-22.541-5.591-17.132-25.968-21.099-56.264-10.82l-12.083 4.147 1.082-12.082c1.263-14.246-1.803-22.001-10.279-26.329-7.033-3.607-20.558-3.246-32.099.902zm50.133 69.789c26.869 7.394 43.28 23.624 43.28 42.919 0 21.46-19.116 40.756-50.133 51.035-16.591 5.41-47.428 6.492-62.576 2.344-28.673-8.115-44.903-23.984-44.903-44.362 0-11.181 4.869-20.919 15.509-30.837 9.918-9.377 17.492-13.886 32.099-18.755 22.001-7.393 45.625-8.295 66.724-2.344zm-56.806 17.492c-18.213 8.476-27.951 21.46-27.951 37.69 0 14.788 6.492 24.886 20.738 32.46 11 5.951 31.198 5.41 43.461-.901 15.689-8.296 25.968-23.624 25.968-38.592-.181-12.263-11.001-26.87-23.804-32.099-10.279-4.328-27.592-3.607-38.412 1.442zm13.165 33.903c1.262 1.262 2.164 4.328 2.164 7.033 0 9.017-15.148 16.411-21.28 10.279-3.426-3.426-2.524-11.902 1.443-15.869 3.967-3.968 14.246-4.869 17.673-1.443zm85.298-117.758c-8.296 8.296-2.705 18.214 10.459 18.214 11.361 0 16.41 5.771 16.41 18.755 0 8.115.722 10.459 3.968 12.623 9.738 6.853 17.673-.721 17.673-16.771 0-19.656-14.067-34.444-34.084-35.887-9.016-.721-11.18-.18-14.426 3.066z"/></svg>
              </span>

              <span class="username">7黑林</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">LinHang的个人Blog，记录自己的想法，分享技术、经验。总的来说能写进来的都会写。也欢迎一起交流技术，谈人生，聊理想  :)</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
